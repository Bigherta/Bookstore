# Cyrene's Bookstore 管理系统用户手册

---

## 1. 系统简介

**Cyrene's Bookstore** 管理系统是一款**基于 C++ 后端与 Qt 前端的图形化书店管理系统**。系统后端严格遵循业务需求，实现帐户管理、图书管理与日志系统；前端基于 Qt Widgets 构建，通过图形界面将命令行功能进行可视化封装，降低用户操作复杂度。

系统特点：

* 支持**多权限用户管理**（店主、员工、顾客、游客）
* 支持**图书查询、购买、维护及进货**
* 提供**财务与员工操作日志查询和报表生成**
* 数据实时存储于文件，生成文件存储在data文件夹中

---

## 2. 运行与启动

### 2.1 启动方式

* 双击 `BookstoreApp.exe`
* 或在命令行执行：

```bash
BookstoreApp.exe
```

首次运行时系统会自动完成初始化：

* 创建超级管理员账户：

  * 用户 ID：`root`
  * 密码：`sjtu`
  * 权限等级：{7}（店主）

首次初始化完成后，可直接进行登录和操作。

---

## 3. 主界面说明

主界面组成：

1. **菜单栏（Menu Bar）**
   位于窗口顶部，分为 **User、Book、Log、Exit** 等功能模块。

2. **功能操作区**
   根据当前功能显示对应对话框，用户可输入参数进行操作。

3. **状态与提示区**
   显示操作结果、错误信息或提示文本。

4. **表格与列表区**
   显示查询结果、交易记录或报表信息，支持排序与筛选。

---

## 4. 帐户系统使用说明

### 4.1 登录与注销

#### 登录账户

1. 菜单栏选择 **User → Login**
2. 输入 **UserID** 与 **Password**
3. 点击 **Login**

> 系统支持**嵌套登录**，后登录的账户为当前操作账户。

#### 注销账户

1. 菜单栏选择 **User → Logout**
2. 撤销最近一次登录的账户
3. 若登录栈为空，注销失败

---

### 4.2 注册与账户管理

#### 注册新用户（游客）

1. 菜单栏选择 **User → Register**
2. 填写 **UserID**、**Password**、**Username**
3. 提交后创建权限为 {1} 的顾客账户

#### 修改密码

1. 菜单栏选择 **User → Change Password**
2. 输入 **原密码** 和 **新密码**
3. 点击 **Confirm** 完成修改

> 店主账户可以直接修改任意账户密码，无需原密码。

#### 用户管理（员工及以上）

* **新增用户**：菜单栏 **User → Add User**
  填写 **UserID、Password、Privilege、Username**
  提交后创建账户，权限不得高于当前操作账户。

* **删除用户**：菜单栏 **User → Delete**
  选择待删除账户，确认删除。已登录账户不可删除。

> 帐户的权限等级有 {7}（店主）, {3}（员工） 和 {1}（顾客）；未登录任何帐户的状态下当前帐户权限视为 {0}（游客），不难推断不可以添加权限为0或7的帐户
> 用户ID与密码支持30位以内仅含数字，字母，下划线的字符串
> 用户姓名支持30位以内除不可见字符以外 ASCII 字符的字符串
---

## 5. 图书系统功能说明

### 5.1 图书查询

1. 菜单栏选择 **Book → Show Books**
2. 填写查询条件（ISBN / 书名 / 作者 / 关键词，可选）
3. 点击 **Search**
4. 查询结果以表格显示，按 **ISBN 升序排列**

> 若无查询结果，表格为空。支持多条件组合查询。

---

### 5.2 购买图书

1. 使用顾客或更高权限账户登录
2. 菜单栏选择 **Book → Buy**
3. 输入 **ISBN** 与 **购买数量**
4. 点击 **Confirm**
5. 系统显示总金额，并减少库存

> 非正数购买数量或不存在的 ISBN 操作将提示错误。

---

### 5.3 图书维护（员工及以上权限）

#### 选择图书

1. 菜单栏选择 **Book → Select**
2. 输入 **ISBN**

   > 若图书不存在，系统自动创建新记录。
   > 当前账户仅可修改选中的图书。

#### 修改图书信息

1. 选择图书后，填写需修改字段（可多项）
2. 点击 **Confirm**
3. 系统验证合法性后更新图书信息

> 不允许重复或空字段修改，修改 ISBN 需保证新 ISBN 唯一。
> ISBN支持20位以内含除不可见字符以外 ASCII 字符的字符串
> 书名、作者以及关键词支持60位以内含除不可见字符和英文双引号以外 ASCII 字符，以及汉字和允许的特殊符号的字符串（一个汉字或者特殊符号算1位）；
> 多个关键词信息修改须用`|`进行分隔，不允许多余的空格
> 允许的特殊符号有间隔号「·」、Em Dash「—」、括号「（」「）」以及冒号「：」

#### 图书进货

1. 选择图书后，菜单栏选择 **Book → Import**
2. 输入 **进货数量** 和 **总成本**
3. 点击 **Confirm**
4. 系统增加库存并记录财务支出

---

## 6. 日志与报表系统（店主）

### 6.1 财务信息查询

1. 菜单栏 **Log → Show Finance**
2. 输入最近交易笔数 N（可选）
3. 点击 **Search**
4. 显示格式：`+ 收入 - 支出`

> N 可为空，表示显示所有交易。

---

### 6.2 财务报表

1. 菜单栏 **Log → Report → Finance**
2. 系统生成格式化报表，显示收入、支出、利润等统计信息

---

### 6.3 员工操作报告

1. 菜单栏 **Log → Report → Employee**
2. 显示员工操作记录，包括登录、修改、进货、销售等

---

### 6.4 系统日志

1. 菜单栏 **Log → Log All**
2. 显示系统运行期间所有关键操作与交易记录

> 仅店主权限可访问日志和报表功能。

---

## 7. 错误提示说明

* 非法操作或参数错误将弹窗提示 **Invalid**
* 权限不足时，菜单项禁用或点击提示权限不足
* 所有输入框支持合法字符校验与长度限制

---

## 8. 退出系统

1. 菜单栏 **Exit → Confirm**
2. 或直接关闭主窗口

> 系统将自动保存所有数据并退出。

---

## 9. 附录：前端界面说明

* **User 菜单**：登录、注销、注册、修改密码、用户管理
* **Book 菜单**：查询、购买、选择、修改、进货
* **Log 菜单**：财务查询、报表、系统日志
* **Exit 菜单**：退出系统
* **表格显示**：查询结果、报表信息

---
